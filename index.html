<!DOCTYPE html><html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>POS Mobile PRO</title>
<style>
:root{
  --bg:#0e0e0e;--card:#1b1b1b;--accent:#2979ff;--ok:#2ecc71;--err:#e74c3c;--warn:#f1c40f;--txt:#f5f5f5;--muted:#888;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui;background:var(--bg);color:var(--txt)}
.hidden{display:none}
.section{padding:12px 12px 90px}
.card{background:var(--card);border-radius:14px;padding:14px;margin-bottom:10px}
.row{display:flex;gap:8px;align-items:center}
.col{flex:1}
input,select,button,textarea{width:100%;padding:12px;border-radius:10px;border:none;background:#232323;color:#fff;font-size:16px}
button{background:var(--accent);font-weight:600}
button.ok{background:var(--ok)}
button.err{background:var(--err)}
button.warn{background:var(--warn);color:#000}
nav{position:fixed;bottom:0;left:0;right:0;display:flex;background:#111;border-top:1px solid #222}
nav button{flex:1;background:#111;color:#aaa;border-radius:0;font-size:13px;padding:10px}
nav button.active{background:var(--accent);color:#fff}
.product{display:flex;justify-content:space-between;gap:10px}
.badge{font-size:12px;color:#000;background:#ccc;border-radius:999px;padding:2px 8px}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.85);display:flex;align-items:center;justify-content:center;z-index:1000}
.modal>div{background:var(--card);border-radius:14px;padding:16px;width:92%;max-height:90vh;overflow:auto}
.list{display:flex;flex-direction:column;gap:8px}
hr{border:none;border-top:1px solid #2a2a2a;margin:10px 0}
.small{font-size:13px;color:var(--muted)}
</style>
</head>
<body><!-- MODAL --><div id="modal" class="modal hidden"><div id="modalContent"></div></div><!-- LOGIN / KASA --><div id="login" class="modal">
  <div>
    <h2> PIN</h2>
    <input id="pinInput" type="tel" inputmode="numeric" placeholder="PIN">
    <button onclick="login()">Zaloguj</button>
  </div>
</div><div id="app" class="hidden">
  <div id="sale" class="section"></div>
  <div id="orders" class="section hidden"></div>
  <div id="clients" class="section hidden"></div>
  <div id="stock" class="section hidden"></div>
  <div id="reports" class="section hidden"></div>
  <div id="settings" class="section hidden"></div>  <nav>
    <button class="active" onclick="view('sale')">Sprzeda偶</button>
    <button onclick="view('orders')">Zam贸wienia</button>
    <button onclick="view('clients')">Klienci</button>
    <button onclick="view('stock')">Magazyn</button>
    <button onclick="view('reports')">Raporty</button>
    <button onclick="view('settings')">Ustawienia</button>
  </nav>
</div><script>
/********************* PINY *************************/
const PIN_ADMIN='1312';
const PIN_CASH_OPEN='1111';
const PIN_DELIVERY='2222';

/********************* LOCAL DB *************************/
const DB={
  load(){return JSON.parse(localStorage.getItem('POS_DB'))||null},
  save(){localStorage.setItem('POS_DB',JSON.stringify(state))}
};

/********************* STATE *************************/
let state=DB.load()||{
  shop:{name:'Sklep POS',tax:23,theme:'dark',color:'#2979ff'},
  cash:{open:false,openAmount:0,closeAmount:0,day:new Date().toDateString()},
  payments:['Got贸wka','BLIK','Karta','Przelew','Punkty'],
  deliveryZones:{'Centrum':20,'Nowa Huta':25,'Poudnie':30,'Inne':35},
  products:[
    {id:1,name:'Produkt A',cat:'Og贸lne',buy:5,sell:10,stock:5,unit:'szt',supplier:'Dostawca 1'}
  ],
  suppliers:[{id:1,name:'Dostawca 1'}],
  clients:[],
  promos:[{type:'2+1',productId:1}],
  sales:[],
  orders:[],
  cart:[],
  activeClient:null
};

/********************* UTILS *************************/
const $=id=>document.getElementById(id);
function save(){DB.save()}
function view(v){document.querySelectorAll('.section').forEach(s=>s.classList.add('hidden'));$(v).classList.remove('hidden');document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));event.target.classList.add('active')}
function modal(html,cb){$('modalContent').innerHTML=html;$('modal').classList.remove('hidden');if(cb)window._modalCb=cb}
function closeModal(){$('modal').classList.add('hidden');window._modalCb=null}

/********************* LOGIN *************************/
function login(){
  if($('pinInput').value===PIN_CASH_OPEN){state.cash.open=true;save();$('login').classList.add('hidden');$('app').classList.remove('hidden');renderSale()}
  else alert('Zy PIN')
}

/********************* SALE *************************/
function renderSale(){
  let h=`<h2>Ь Sprzeda偶</h2>`;
  state.products.forEach(p=>{
    h+=`<div class='card product'><div><b>${p.name}</b><br><span class='small'>${p.sell} PLN | Stan: ${p.stock}</span></div><button onclick='addToCart(${p.id})'>Dodaj</button></div>`;
  });
  h+=`<hr><div class='card'><h3>Koszyk</h3>`;
  let total=0;
  state.cart.forEach((c,i)=>{total+=c.sell*c.qty;h+=`<div class='row'><div class='col'>${c.name} x ${c.qty}</div><div>${c.sell*c.qty} PLN</div><button onclick='inc(${i})'>+</button><button onclick='dec(${i})'>-</button></div>`});
  h+=`<hr><b>Suma: ${total} PLN</b><button class='ok' onclick='checkout()'>Zakocz</button></div>`;
  $('sale').innerHTML=h;
}

function addToCart(id){
  let p=state.products.find(x=>x.id===id);
  if(p.stock<=0){
    modal(`<h3>Brak stanu</h3><input id='mpin' type='tel' placeholder='PIN'><button class='ok' onclick="if($('mpin').value==='${PIN_ADMIN}'){$('modal').classList.add('hidden');forceAdd(${id})}else alert('Zy PIN')">Wymu</button>`);
  }else forceAdd(id)
}
function forceAdd(id){
  let p=state.products.find(x=>x.id===id);
  let c=state.cart.find(x=>x.id===id);
  if(c)c.qty++; else state.cart.push({...p,qty:1});
  save();renderSale()
}
function inc(i){state.cart[i].qty++;renderSale();save()}
function dec(i){state.cart[i].qty--;if(state.cart[i].qty<=0)state.cart.splice(i,1);renderSale();save()}

/********************* CHECKOUT *************************/
function checkout(){
  let total=state.cart.reduce((s,c)=>s+c.sell*c.qty,0);
  modal(`<h3>Patno</h3>
  <select id='pay1'>${state.payments.map(p=>`<option>${p}</option>`)}</select>
  <input id='amt1' type='number' placeholder='Kwota'>
  <select id='pay2'>${state.payments.map(p=>`<option>${p}</option>`)}</select>
  <input id='amt2' type='number' placeholder='Kwota'>
  <p>Suma: ${total} PLN</p>
  <button class='ok' onclick='finishSale(${total})'>Zatwierd藕</button>`)
}
function finishSale(total){
  let a1=Number($('amt1').value||0),a2=Number($('amt2').value||0);
  if(a1+a2<total){alert('Za mao');return}
  state.cart.forEach(c=>{let p=state.products.find(x=>x.id===c.id);if(p.stock>0)p.stock-=c.qty});
  state.sales.push({date:new Date(),items:state.cart,total});
  state.cart=[];save();closeModal();renderSale();alert('Sprzeda偶 OK')
}

/********************* ORDERS *************************/
function renderOrders(){
  let h=`<h2> Zam贸wienia</h2><button onclick='newOrder()'>Nowe</button>`;
  state.orders.forEach(o=>{h+=`<div class='card'>${o.client} | ${o.date} | ${o.total} PLN | ${o.zone}</div>`});
  $('orders').innerHTML=h
}
function newOrder(){
  modal(`<h3>Nowe zam贸wienie</h3><input id='oclient' placeholder='Klient'><input id='odate' type='date'><select id='ozone'>${Object.keys(state.deliveryZones).map(z=>`<option>${z}</option>`)}</select><button class='ok' onclick='saveOrder()'>Zapisz</button>`)
}
function saveOrder(){
  let zone=$('ozone').value;let fee=state.deliveryZones[zone];
  state.orders.push({client:$('oclient').value,date:$('odate').value,zone,total:fee});save();closeModal();renderOrders()
}

/********************* CLIENTS *************************/
function renderClients(){
  let h=`<h2> Klienci</h2><button onclick='addClient()'>Dodaj</button>`;
  state.clients.forEach(c=>h+=`<div class='card'>${c.name} | Punkty: ${c.points}</div>`);
  $('clients').innerHTML=h
}
function addClient(){modal(`<h3>Klient</h3><input id='cname'><button class='ok' onclick="state.clients.push({name:$('cname').value,points:0,history:[]});save();closeModal();renderClients()">Zapisz</button>`)}

/********************* STOCK *************************/
function renderStock(){
  let h=`<h2> Magazyn</h2>`;
  state.products.forEach(p=>h+=`<div class='card'>${p.name} | ${p.stock} | ${p.sell} PLN</div>`);
  $('stock').innerHTML=h
}

/********************* REPORTS *************************/
function renderReports(){
  let profit=0;state.sales.forEach(s=>profit+=s.total);
  $('reports').innerHTML=`<h2> Raport</h2><div class='card'>Sprzeda偶: ${state.sales.length}<br>Obr贸t: ${profit} PLN</div>`
}

/********************* SETTINGS *************************/
function renderSettings(){
  $('settings').innerHTML=`<h2>锔 Ustawienia</h2><div class='card'><input value='${state.shop.name}' onchange="state.shop.name=this.value;save()"><input type='number' value='${state.shop.tax}' onchange="state.shop.tax=this.value;save()"></div>`
}

/********************* INIT *************************/
renderSale();renderOrders();renderClients();renderStock();renderReports();renderSettings();
</script></body>
</html>
